<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ex.128J</title>
</head>

<style>
    #app {
        height: 300px;
        width: 300px;
        display: grid;
        grid-template-columns: repeat(3, auto);
        grid-template-rows: repeat(3, auto);
        border: 3px solid black;
        background-color: gray;
    }

    [id*="cell"] {
        display: grid;
        justify-content: center;
        align-items: center;
        font-size: 32px;
        border: 1px solid black;
        border-radius: 25%;
        background-color: white;
        margin: 1px;
    }
</style>

<body>
    <div id="app"></div>
    <script>
        drawTheNetWithRandom();

        function drawTheNetWithRandom() {
            let div = document.getElementById("app");
            let shuffledArrayOfDivs = getRandomizedArrayOfDiv();
            let emptyCell = `<div id="cell9" class = "empty"></div>`;
            for (let i = 0; i < shuffledArrayOfDivs.length; i++) {
                if (shuffledArrayOfDivs[i].includes("9")) {
                    div.innerHTML += emptyCell;
                }
                else {
                    div.innerHTML += shuffledArrayOfDivs[i];
                }
            }
        }

        function getRandomizedArrayOfDiv() {
            let normalArray = [];
            let length = 9;
            for (let i = 0; i < length; i++) {
                let oneDive = `<div id="cell${i + 1}" onclick = "swapIfPossible(${i + 1})">${i + 1}</div>`
                normalArray.push(oneDive);
            }
            return shuffle(normalArray);
        }
        function shuffle(array) {
            let currentIndex = array.length;

            // While there remain elements to shuffle...
            while (currentIndex != 0) {
                // Pick a remaining element...
                let randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;

                // And swap it with the current element.
                [array[currentIndex], array[randomIndex]] = [
                    array[randomIndex], array[currentIndex]];
            }
            return array;
        }
        function swapIfPossible(id) {
   
            let myString = document.getElementById("app").innerHTML;
            const divArray = myString.match(/<div\b[^>]*>.*?<\/div>/g);

            for (let i = 0; i < divArray.length; i++) {
            
                if (divArray[i].includes(id)) {
                   // console.log("This element needs to check on emptyness near: " + divArray[i] + " and this is his number " + i);
                    swapElementsAndRedrawDiv(divArray, i);
                    break;
                }
            }
        }

        function swapElementsAndRedrawDiv(array, iter) {
            let cellThatIsEmpty = 0;
            for (let i = 0; i < array.length; i++) {
                if (array[i].includes("empty")) {
                    cellThatIsEmpty = i;
                    break;
                }
            }
            console.log("This is cell that was clicked: " + iter + "\n" + "And this is id of cell that is empty: " + cellThatIsEmpty);
            // 0 1 2 3 4 5 6 7 8
            if (iter == 0 && (cellThatIsEmpty == 1)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }
            else if (iter == 0 && (cellThatIsEmpty == 3)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }

            else if (iter == 1 && (cellThatIsEmpty == 0)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }
            else if (iter == 1 && (cellThatIsEmpty == 2)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }
            else if (iter == 1 && (cellThatIsEmpty == 4)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }

            else if (iter == 2 && (cellThatIsEmpty == 1)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }
            else if (iter == 2 && (cellThatIsEmpty == 5)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }

            else if (iter == 3 && (cellThatIsEmpty == 0)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }
            else if (iter == 3 && (cellThatIsEmpty == 4)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }
            else if (iter == 3 && (cellThatIsEmpty == 6)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }

            else if (iter == 4 && (cellThatIsEmpty == 1)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }
            else if (iter == 4 && (cellThatIsEmpty == 3)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }
            else if (iter == 4 && (cellThatIsEmpty == 5)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }
            else if (iter == 4 && (cellThatIsEmpty == 7)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }

            else if (iter == 5 && (cellThatIsEmpty == 2)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }
            else if (iter == 5 && (cellThatIsEmpty == 4)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }
            else if (iter == 5 && (cellThatIsEmpty == 8)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }

            else if (iter == 6 && (cellThatIsEmpty == 3)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }
            else if (iter == 6 && (cellThatIsEmpty == 7)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }

            else if (iter == 7 && (cellThatIsEmpty == 4)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }
            else if (iter == 7 && (cellThatIsEmpty == 6)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }
            else if (iter == 7 && (cellThatIsEmpty == 8)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }

            else if (iter == 8 && (cellThatIsEmpty == 5)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }
            else if (iter == 8 && (cellThatIsEmpty == 7)) { [array[iter], array[cellThatIsEmpty]] = [array[cellThatIsEmpty], array[iter]]; }

            document.getElementById("app").innerHTML = ``;
            for (let i = 0; i < array.length; i++) {
                document.getElementById("app").innerHTML += array[i];
            }
        }
    </script>
</body>

</html>